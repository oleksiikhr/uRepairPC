(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{301:function(e,t,n){"use strict";n.d(t,"b",function(){return i});var i=["Home","Requests","Users","Settings","Roles","SettingsCore"];t.a=[].concat(i,["EquipmentManufacturers","EquipmentModels","EquipmentTypes","RequestStatuses","RequestPriorities","RequestTypes","Manifest","Global"])},302:function(e,t,n){"use strict";var i=n(28),s=n.n(i),a=n(301),o=n(18),r=n(0),u=n(99);function l(e){var t=u.a[r.a.home].title;return e?{title:t,routeName:o.a}:{title:t}}t.a={activated:function(){this.$nextTick(this.updateBreadcrumbs)},mounted:function(){this.$options.name&&a.a.includes(this.$options.name)||this.$nextTick(this.updateBreadcrumbs)},methods:{updateBreadcrumbs:function(){this.$options.breadcrumbs?this.$store.commit("template/SET_BREADCRUMBS",[l(!0)].concat(s()(this.$options.breadcrumbs))):this.$store.commit("template/SET_BREADCRUMBS",[l(!1)])}}}},305:function(e,t,n){"use strict";var i=n(302),s=n(99);t.a=function(e){return{breadcrumbs:[{title:s.a[e].title,routeName:e},{title:function(e){return"ID: ".concat(e.params.id||-1)}}],mixins:[i.a],data:function(){return{pageId:+this.$route.params.id}},computed:{model:function(){var t=this.$store.state.template.sidebar[e];return t&&t[this.pageId]?t[this.pageId]:{}},hasFetchDataFunc:function(){return"function"==typeof this.fetchData}},watch:{$route:function(){this.hasFetchDataFunc&&this.fetchData()}},created:function(){this.hasFetchDataFunc&&this.fetchData()}}}},309:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var i=n(7),s=n.n(i),a=n(6),o=n.n(a),r=n(5),u=n.n(r),l=function(){function e(){s()(this,e)}return o()(e,null,[{key:"__API_POINT",value:function(e){return"equipments/".concat(e,"/files")}},{key:"fetchAll",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return u.a.get(this.__API_POINT(e),t)}},{key:"fetchEdit",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return u.a.put("".concat(this.__API_POINT(e),"/").concat(t),n,i)}},{key:"fetchStore",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return u.a.post(this.__API_POINT(e),t,n)}},{key:"fetchDelete",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return u.a.delete("".concat(this.__API_POINT(e),"/").concat(t),n)}}]),e}()},319:function(e,t,n){},367:function(e,t,n){"use strict";var i=n(319);n.n(i).a},427:function(e,t,n){"use strict";n.r(t);var i=n(28),s=n.n(i),a=n(3),o=n.n(a),r=n(309),u=n(102),l=n(10),c=n(30),d=n(0),f=n(305),h=n(1),p=n(15);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(n,!0).forEach(function(t){o()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var E={components:{TemplateOne:function(){return n.e(10).then(n.bind(null,463))},FilesList:function(){return n.e(21).then(n.bind(null,464))}},mixins:[Object(f.a)(d.a.equipments)],data:function(){return{perm:h,loading:!1,loadingFiles:!1}},computed:{buttons:function(){var e=this;return[{title:"Оновити",type:p.a.SUCCESS,disabled:this.loading,action:function(){e.fetchRequest(),e.fetchRequestFiles()}},{title:"Редагувати",type:p.a.PRIMARY,permissions:[h.EQUIPMENTS_EDIT_ALL,this.model.user_id===this.profile.id&&h.EQUIPMENTS_EDIT_OWN],action:function(){return e.openDialog(n.e(91).then(n.bind(null,487)))}},{title:"Завантажити файл",type:p.a.PRIMARY,permissions:h.EQUIPMENTS_FILES_CREATE,action:function(){return e.openDialog(n.e(20).then(n.bind(null,488)))}},{title:"Видалили",type:p.a.DANGER,permissions:[h.EQUIPMENTS_DELETE_ALL,this.model.user_id===this.profile.id&&h.EQUIPMENTS_DELETE_OWN],action:function(){return e.openDialog(n.e(107).then(n.bind(null,489)))}}]},tableData:function(){var e=this,t=["type_name","manufacturer_name","model_name","description","created_at","updated_at"],n=[];return this.$store.getters["equipments/columns"].forEach(function(i){t.includes(i.prop)&&n.push(_({},i,{value:e.model[i.prop]}))}),n},profile:function(){return this.$store.state.profile.user},filesPermissions:function(){var e=this;return{"permission-create":h.EQUIPMENTS_FILES_CREATE,"permission-download":function(t){return Object(l.d)(h.EQUIPMENTS_FILES_DOWNLOAD_ALL)||Object(l.d)(h.EQUIPMENTS_FILES_DOWNLOAD_OWN)&&t.user_id===e.profile.id},"permission-edit":function(t){return Object(l.d)(h.EQUIPMENTS_FILES_EDIT_ALL)||Object(l.d)(h.EQUIPMENTS_EDIT_OWN)&&t.user_id===e.profile.id},"permission-delete":function(t){return Object(l.d)(h.EQUIPMENTS_FILES_DELETE_ALL)||Object(l.d)(h.EQUIPMENTS_DELETE_OWN)&&t.user_id===e.profile.id}}},canSeeFiles:function(){return Object(l.d)([h.EQUIPMENTS_FILES_VIEW_ALL,h.EQUIPMENTS_FILES_VIEW_OWN])}},methods:{fetchData:function(){this.model.id||this.fetchRequest(),this.model.files||this.fetchRequestFiles()},fetchRequest:function(){var e=this;this.loading=!0,u.a.fetchOne(this.pageId).catch(function(){e.$router.push({name:d.a.equipments})}).finally(function(){e.loading=!1})},fetchRequestFiles:function(){var e=this;this.canSeeFiles&&(this.loadingFiles=!0,this.updateFiles([]),r.a.fetchAll(this.pageId).then(function(t){var n=t.data;e.updateFiles(n.equipment_files)}).finally(function(){e.loadingFiles=!1}))},copy:function(e,t){t&&Object(c.a)(e.target)},openDialog:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.$store.commit("template/OPEN_DIALOG",{component:function(){return e},attrs:_({equipment:this.model},n),events:{delete:function(){t.$router.push({name:d.a.equipments})},"files-upload":function(e){t.updateFiles([].concat(s()(e),s()(t.model.files)))},"file-update":function(e,n){var i=s()(t.model.files);i[n]=e,t.updateFiles(i)},"file-delete":function(e){var n=s()(t.model.files);n.splice(e,1),t.updateFiles(n)}}})},updateFiles:function(e){u.a.sidebar().add({id:this.pageId,files:e})},onAdd:function(){this.openDialog(n.e(20).then(n.bind(null,488)))},onEdit:function(e,t){this.openDialog(n.e(92).then(n.bind(null,490)),{file:e,index:t})},onDelete:function(e,t){this.openDialog(n.e(108).then(n.bind(null,491)),{file:e,index:t})}}},v=(n(367),n(98)),b=Object(v.a)(E,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("template-one",{attrs:{buttons:e.buttons,"table-data":e.tableData,loading:e.loading}},[n("div",{staticClass:"header__wrap",attrs:{slot:"header"},slot:"header"},[n("div",{staticClass:"header-item"},[n("div",{staticClass:"header-item__title"},[e._v("\n        Серійний номер\n      ")]),e._v(" "),n("div",{class:["header-item__value",{has_value:!!e.model.serial_number}],on:{click:function(t){return e.copy(t,e.model.serial_number)}}},[n("span",[e._v(e._s(e.model.serial_number))])])]),e._v(" "),n("div",{staticClass:"header-item"},[n("div",{staticClass:"header-item__title"},[e._v("\n        Інвертарний номер\n      ")]),e._v(" "),n("div",{class:["header-item__value",{has_value:!!e.model.inventory_number}],on:{click:function(t){return e.copy(t,e.model.inventory_number)}}},[n("span",[e._v(e._s(e.model.inventory_number))])])])]),e._v(" "),e.model.files&&(e.model.files.length||e.loadingFiles)?n("div",{staticClass:"page--width"},[n("div",{staticClass:"divider"},[n("span",[e._v("Файли")])]),e._v(" "),n("div",[n("files-list",e._b({attrs:{files:e.model.files,loading:e.loadingFiles,"url-download":function(t){return"equipments/"+e.model.id+"/files/"+t.id}},on:{add:e.onAdd,edit:e.onEdit,delete:e.onDelete,refresh:e.fetchRequestFiles}},"files-list",e.filesPermissions,!1))],1)]):e._e()])},[],!1,null,"f978d9de",null);t.default=b.exports}}]);